<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>
    Application Structure - hack(pravj) | Pravendra Singh
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="My name is Pravendra Singh and I love playing with data. R(ETL)PL."/>
<meta name="keywords" content="blog, web, data, data visualization, golang, programming, python, Pravendra Singh, Pravendra, pravj, IIT, IIT Roorkee">
<meta name="author" content="Pravendra Singh">
<meta http-equiv="cleartype" content="on">

  <meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Pravendra Singh - Falling Leaves">
<meta property="og:title" content="Application Structure" />
<meta property="og:type" content="article" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://pravj.github.io/articles/application-structure/" />
<meta property="og:description" content="In this post, we&rsquo;re going to talk about a seemingly easy but an important topic - organizing and structuring your flask applications.
As mentioned earlier, getting started with flask is super easy. Unlike django, flask doesn&rsquo;t follow a directory structure when you start a new app. Flask will not complain even if all of your code resides in a single main.py file. But we all know that that is not the way to go." />

<meta property="og:image" content=" http://pravj.github.io/images/pravj-monu-art.jpg "/>

<meta property="article:author" content="https://www.facebook.com/hackpravj" />
<meta property="article:publisher" content="https://www.facebook.com/hackpravj" />

  <meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@hackpravj">
<meta name="twitter:creator" content="@hackpravj">
<meta name="twitter:title" content="Application Structure" />
<meta name="twitter:description" content="In this post, we&rsquo;re going to talk about a seemingly easy but an important topic - organizing and structuring your flask applications.
As mentioned earlier, getting started with flask is super easy. Unlike django, flask doesn&rsquo;t follow a directory structure when you start a new app. Flask will not complain even if all of your code resides in a single main.py file. But we all know that that is not the way to go." />


<meta property="twitter:image" content=" http://pravj.github.io/images/pravj-monu-art.jpg "/>





  <link href='https://fonts.googleapis.com/css?family=Raleway:400|Source+Serif+Pro:400,300,600' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="https://pravj.github.io/styles.min.css">

  

  

  
  <link rel="apple-touch-icon" sizes="180x180" href="/images/header-images/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/images/header-images/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/header-images/favicon-16x16.png" sizes="16x16">
  <link rel="mask-icon" href="/images/header-images/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/header-images/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/images/header-images/favicon.ico">

  
  <link href="" rel="alternate" type="application/rss+xml" title="hack(pravj)" />


  
</head>


<body>
      <div class="post-header">
  <div class="container rrr">
    <div class="row">
      <div class="six columns">
        <h4><a href="/">PRAVENDRA SINGH</a></h4>
      </div>
      <div class="six columns">
        <nav>
          <ul class="nav-list">
            <li><a href="/about" title="About Me"><i class="icon-user"></i></a></li>
            <li><a href="/blog" title="Articles"><i class="icon-article-alt"></i></a></li>
            <li><a href="/projects" title="Projects"><i class="icon-github-circled"></i></a></li>
            <li><a href="/quotes" title="Quotes"><i class="icon-quote-left"></i></a></li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>




  <div class="container">
    <div class="row">

      <section>
            <h1 class="post-title">
              <a href="/articles/application-structure/">Application Structure</a>
            </h1>

          <div class="post-content-meta">

            
              <i class="icon-calendar"></i>  
              <span class="post-date">
                <span class="post-date-month">May</span> 
                <span class="post-date-day"> 7, </span>
                <span class="post-date-year">2013</span>
              </span> 
            

            
            
                <span class="post-tag"> in </span>
                
                <a class="post-tag post-tag-python" href="https://pravj.github.io/tags/python">
                  <i class="icon-tag"></i>python</a>
                
                <a class="post-tag post-tag-flask" href="https://pravj.github.io/tags/flask">
                  <i class="icon-tag"></i>flask</a>
                
            

         </div>

			

      <div class="post-content">
        

<p>In this post, we&rsquo;re going to talk about a seemingly easy but an important topic - organizing and structuring your flask applications.</p>

<p>As mentioned earlier, getting started with flask is super easy. Unlike django, flask doesn&rsquo;t follow a directory structure when you start a new app. Flask will not complain even if all of your code resides in a single <code>main.py</code> file. But we all know that that is not the way to go. Having all your code in one file makes it messy and unmaintainable.</p>

<p>Lets assume that you&rsquo;ve gone through the throughly explained <a href="http://flask.pocoo.org/docs/tutorial/">flaskr tutorial</a> (which you definitely should in case you haven&rsquo;t) and unable to contain the excitement you start a new flask app. As you keep writing more code and see it working you start getting that nice feeling about the awesomeness of flask. However, as your code keeps growing and since its all in a single file you start getting frustrated. Configurations, models, views etc. should definitely go in separate files, you think, so that your application is kept modular. But where do you start?</p>

<p>This post will provide you an answer and show you a good way of structuring your apps. For starters, the flask <a href="http://flask.pocoo.org/docs/patterns/packages/">patterns site</a> provides an easy-to-follow tutorial for structuring an app. This post will cover that and will go beyond by covering configuration module and an extension called <a href="http://flask-script.readthedocs.org/en/latest/">flask-script</a>. Lets get started!</p>

<h3 id="packages">Packages</h3>

<p>For larger applications going the packages way is generally a good idea.  A small app might look like this -</p>

<pre><code>- myapp
  |- static
  |- templates
  |- main.py
</code></pre>

<p>To change this into a python module all you need to do is move the files in a separate folder and create a new file ( or rename the existing <code>main.py</code> ) <code>__init__.py</code> so that python can interpret the folder as a module. After re-structuring your app will look like this -</p>

<pre><code>- myapp
  |- hello
    |-- __init__.py
    |-- static
    |-- templates
    |-- main.py
</code></pre>

<p>The next step is to separate app initialization, models and views declaration from your <code>__init__.py</code>. To do that write the following code in your <code>__init__.py</code>. Note: I&rsquo;m assuming that you&rsquo;re assuming sqlalchemy as your ORM. Additionally, I&rsquo;ve used hello as the name of the app folder.</p>

<pre><code># flask imports go here
from flask import Flask
from flask.ext.sqlalchemy import SQLAlchemy
import os

# declaring the app
app = Flask(__name__)

# get the base dir
base_dir = os.path.dirname(os.path.abspath(__file__))
app.config.from_pyfile(os.path.join(base_dir, '../app.cfg'))

# create db
db = SQLAlchemy(app)

# importing views
import hello.views

# import models
from hello.models.person import Person
</code></pre>

<p>In this code, you&rsquo;ll notice that <code>hello.views</code>, <code>hello.models.person</code> and <code>app.cfg</code> are missing files. Don&rsquo;t worry, we&rsquo;ll create them soon. The rest of the code is self-explainatory. We get the base directory so that we can easily reference the config file to instantiate our app.</p>

<h3 id="application-configuration">Application Configuration</h3>

<p>The next step is to create the missing files. In your app (in my case -
hello) folder, create a new folder called <code>models</code> and add your models
(either separately or all in single file).  Dont forget to create a
blank <code>__init__.py</code> file in this folder as well. Next, create a file
called <code>app.cfg</code> to store your configuration. This file should reside
alongside your app (or hello) folder. Finally, inside your app (or
hello) folder add all your views in a file <code>views.py</code>. Below is a sample
excerpt of how your files should look like.</p>

<pre><code># sample app.cfg
DEBUG = True
SECRET= &quot;mysupersecretkey&quot;

# dummy model inside models folder
# filename hello/models/dummy.py
from hello import db
class Dummy(db.Model):
  pass

# views inside hello/views.py
from hello import app
from hello.models.dummy import Dummy
from flask import render_template
@app.route('/')
def hello():
  return render_template('index.html')
</code></pre>

<p>At this stage this is how your structure looks like -</p>

<pre><code>- myapp
  |- app.cfg
  |- hello
    |-- __init__.py
    |-- static/
    |-- templates/
    |-- views.py
    |-- models/
      |--- __init__.py
      |--- dummy.py
</code></pre>

<p>If you&rsquo;ve noticed we still haven&rsquo;t told our app to run. To do that, create
a new file called <code>manage.py</code> alongside <code>app.cfg</code> and enter the
following code -</p>

<pre><code>from hello import app
from hello import db

if __name__ == &quot;__main__&quot;:
  app.run()
</code></pre>

<p>Now that you have everything setup, your app should work. Give it a go by running <code>python manage.py</code>
and make sure there aren&rsquo;t any import errors.</p>

<h3 id="flask-script">Flask Script</h3>

<p>One last thing I need to introduce before we wrap up is a flask extension called
<a href="http://flask-script.readthedocs.org/en/latest/">flask-script</a>. The
flask-script extensions provides support for writing scripts and makes
it super easy to add commands that can runserver, open shell, manage
cronjobs and other things right from the terminal. The documentation for
the extension is very easy to follow and I encourage you to give it a
read. I&rsquo;ve edited the <code>manage.py</code> file and added support for
flask-script.</p>

<pre><code>from flask.ext.script import Manager, Server, Shell
from hello import app
from hello import db

# (optional) - include models if you want to!
import hello.models as models

def _make_context():
  &quot;&quot;&quot; context for passing into to the shell command &quot;&quot;&quot;
  return dict(app=app, db=db, models=models)

# set manager
manager = Manager(app)

# add commands
manager.add_command(&quot;runserver&quot;, Server())
manager.add_command(&quot;shell&quot;, Shell(make_context = _make_context))

if __name__ == &quot;__main__&quot;:
  manager.run()
</code></pre>

<p>After making these changes, simply run <code>python manage.py runserver</code> to
run the app and <code>python manage.py shell</code> to jump into a python shell
with your application context, db and models loaded!</p>

<p>I hope this has been a fun tutorial for you to follow. If there are any
issues feel free to email me.</p>

<p>The code for this lesson is available on my <a href="https://github.com/prakhar1989/flask-tuts/tree/master/lesson-1/hello">github</a>.</p>

<p>In the next post we&rsquo;re going to delve further into the topic of project structure by taking a look at <strong>blueprints in Flask</strong>.</p>

<p>See you next time!</p>

      </div>
	
			

      </div>

      <div class="row paging">
			
          
          <div class="six columns">
            <a class="paging-link" href="/articles/beginning-flask/"><i class="icon-left-open"></i> Beginning Flask</a>
          </div>
          

					
          <div class="paging-newer six columns">
            <a class="paging-link" href="/articles/class-based-views/">Class Based Views <i class="icon-right-open"></i></a>
          </div>
          

      
       </div>


    </div>
  </div>

  
  <div class="container">
    <div class="row" id="disqus_area">
      <a href="#" id="disqus_load" onclick="return loadDisqus()">Add / View Comments</a>
<div id="disqus_thread"></div>

<script type="text/javascript">
  var disqus_shortname = 'pravj';

  function loadDisqus() {
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

  
  document.getElementById('disqus_load').style.display = 'none';
  return false;
}
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
  </div>
  


	

	

    <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-48537986-1', 'auto');
  ga('send', 'pageview');
</script>

    </div>
      <div class="footer">
	<hr class="thin" />
  <p>Powered by <a href="https://gohugo.io/">Hugo</a> on <a href="https://pages.github.com/">GitHub Pages</a></p>
</div>

  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://pravj.github.io/main.js"></script>






<script async defer src="https://buttons.github.io/buttons.js"></script>



</body>
</html>
