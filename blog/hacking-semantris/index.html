<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>
    Hacking Semantris: The Google AI Experiment - hack(pravj) | Pravendra Singh
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="My name is Pravendra Singh and I love playing with data. R(ETL)PL."/>
<meta name="keywords" content="blog, web, data, data visualization, golang, programming, python, Pravendra Singh, Pravendra, pravj, IIT, IIT Roorkee">
<meta name="author" content="Pravendra Singh">
<meta http-equiv="cleartype" content="on">

  <meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Pravendra Singh - Falling Leaves">
<meta property="og:title" content="Hacking Semantris: The Google AI Experiment" />
<meta property="og:type" content="article" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://hackpravj.com/blog/hacking-semantris/" />
<meta property="og:description" content="Semantris is a set of word association games that use semantic search to predict a relevant word in the game based on the player&rsquo;s input.
 ARCADE Arcade mode requires a player to quickly come up with associated words for certain words. You are supposed to think and type as fast as you can before an increasing list of words fills your screen.
BLOCKS Blocks is a turn-based game mode." />

<meta property="og:image" content=" https://hackpravj.com/images/pravj-monu-art.jpg "/>

<meta property="article:author" content="https://www.facebook.com/hackpravj" />
<meta property="article:publisher" content="https://www.facebook.com/hackpravj" />

  <meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@hackpravj">
<meta name="twitter:creator" content="@hackpravj">
<meta name="twitter:title" content="Hacking Semantris: The Google AI Experiment" />
<meta name="twitter:description" content="Semantris is a set of word association games that use semantic search to predict a relevant word in the game based on the player&rsquo;s input.
 ARCADE Arcade mode requires a player to quickly come up with associated words for certain words. You are supposed to think and type as fast as you can before an increasing list of words fills your screen.
BLOCKS Blocks is a turn-based game mode." />


<meta property="twitter:image" content=" https://hackpravj.com/images/pravj-monu-art.jpg "/>





  <link href='https://fonts.googleapis.com/css?family=Raleway:400|Source+Serif+Pro:400,300,600' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="https://hackpravj.com/styles.min.css">

  

  

  
  <link rel="apple-touch-icon" sizes="180x180" href="/images/header-images/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/images/header-images/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/header-images/favicon-16x16.png" sizes="16x16">
  <link rel="mask-icon" href="/images/header-images/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/header-images/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/images/header-images/favicon.ico">

  
  <link href="" rel="alternate" type="application/rss+xml" title="hack(pravj)" />


  
</head>


<body>
      <div class="post-header">
  <div class="container rrr">
    <div class="row">
      <div class="six columns">
        <h4><a href="/">PRAVENDRA SINGH</a></h4>
      </div>
      <div class="six columns">
        <nav>
          <ul class="nav-list">
            <li><a href="/about" title="About Me"><i class="icon-user"></i></a></li>
            <li><a href="/blog" title="Articles"><i class="icon-article-alt"></i></a></li>
            <li><a href="/projects" title="Projects"><i class="icon-github-circled"></i></a></li>
            <li><a href="/quotes" title="Quotes"><i class="icon-quote-left"></i></a></li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>




  <div class="container">
    <div class="row">

      <section>
            <h1 class="post-title">
              <a href="/blog/hacking-semantris/">Hacking Semantris: The Google AI Experiment</a>
            </h1>

          <div class="post-content-meta">

            
              <i class="icon-calendar"></i>  
              <span class="post-date">
                <span class="post-date-month">December</span> 
                <span class="post-date-day"> 2, </span>
                <span class="post-date-year">2018</span>
              </span> 
            

            
            
                <span class="post-tag"> in </span>
                
                <a class="post-tag post-tag-computer-vision" href="https://hackpravj.com/tags/computer-vision">
                  <i class="icon-tag"></i>Computer Vision</a>
                
                <a class="post-tag post-tag-opencv" href="https://hackpravj.com/tags/opencv">
                  <i class="icon-tag"></i>OpenCV</a>
                
                <a class="post-tag post-tag-nlp" href="https://hackpravj.com/tags/nlp">
                  <i class="icon-tag"></i>NLP</a>
                
                <a class="post-tag post-tag-hack" href="https://hackpravj.com/tags/hack">
                  <i class="icon-tag"></i>Hack</a>
                
            

         </div>

			

      <div class="post-content">
        

<blockquote>
<p><a href="https://experiments.withgoogle.com/semantris">Semantris</a> is a set of word association games that use semantic search to predict a relevant word in the game based on the player&rsquo;s input.</p>
</blockquote>

<h4 id="arcade">ARCADE</h4>

<p>Arcade mode requires a player to quickly come up with associated words for certain words. You are supposed to think and type as fast as you can before an increasing list of words fills your screen.</p>

<h4 id="blocks">BLOCKS</h4>

<p>Blocks is a turn-based game mode. You can take your time to come up with different types of clues and see which ones the game understands best.</p>

<figure> <img src="/images/semantris-combined.jpg">
        <figcaption>Semantris ARCADE and BLOCKS modes</figcaption>
</figure>

<blockquote>
<p>In the name of <strong>automating everything</strong>, I wrote a program <a href="https://github.com/pravj/semantris-solver">(Semantris-Solver)</a> that can play both the modes on its own. In this post, I will explain how the program works.</p>
</blockquote>

<p>In simple terms, it follows these steps:</p>

<ol>
<li><strong>Capture the game state using computer vision techniques (OpenCV)</strong></li>
<li><strong>Identify the word to enter for higher reward (OCR)</strong></li>
<li><strong>Find the word associated for it using word embedding (Word2Vec)</strong></li>
</ol>

<p>Sounds fun? Keep reading to know more about it in details.</p>

<h3 id="b-arcade-think-fast-type-fast-b"><b>ARCADE (think fast; type fast)</b></h3>

<h4 id="game-flow">GAME FLOW</h4>

<p>For a human player, the arcade mode looks something like this:</p>

<ol>
<li>Find one or more highlighted words in the game (<i>face</i>)</li>
<li>Get these words in the highlighted area by entering their associated words (<i>mask</i> worked for <i>face</i>; <i>bike</i> did not)</li>
<li>Keep doing this before you run out of space on your screen for new words</li>
</ol>

<figure> <img src="/images/semantris-arcade.gif">
        <figcaption>Semantris ARCADE game</figcaption>
</figure>

<h4 id="capturing-highlighted-words">CAPTURING HIGHLIGHTED WORDS</h4>

<p>There are 3 possible color themes in the arcade mode.</p>

<figure> <img src="/images/semantris-arcade-theme-colors.jpg">
        <figcaption>Semantris ARCADE color themes</figcaption>
</figure>

<p><b>Color Space Conversion</b></p>

<p>The program starts with capturing the device screenshot and then converts it (the image) into grayscale, making it <b>theme-color agnostic</b>.</p>

<figure> <img src="/images/semantris-arcade-gray-scale.png">
        <figcaption>Semantris ARCADE gray scale</figcaption>
</figure>

<p><b>Template Matching</b></p>

<blockquote>
<p>Each highlighted word has a pointer shape left to it, for example (‎▶ <b>Ship</b>).</p>
</blockquote>

<p><a href="https://docs.opencv.org/3.3.0/d4/dc6/tutorial_py_template_matching.html">OpenCV template matching</a> can find a template image in a given image based on multiple similarity methods.</p>

<figure> <img src="/images/semantris-arcade-selected-highlighted-word.png">
        <figcaption>Semantris ARCADE highlighted word selection</figcaption>
</figure>

<p>An approximate rectangle is cut right next to the template image section to crop the desired word.
<figure> <img src="/images/semantris-arcade-highlighted-word.png">
        <figcaption>Semantris ARCADE highlighted word</figcaption>
</figure></p>

<p>The cropped image is converted into text using <a href="https://github.com/tesseract-ocr/tesseract">tesseract OCR</a>.
In case of more than one such words, they are entered one after another to keep the game moving.</p>

<h4 id="associated-word">ASSOCIATED WORD</h4>

<p><a href="https://github.com/mmihaltz/word2vec-GoogleNews-vectors">Word2Vec pre-trained on Google News corpus</a> is used as a word embedding model to find the <a href="https://radimrehurek.com/gensim/models/word2vec.html#gensim.models.word2vec.Word2Vec.most_similar">most similar</a> words (associated) for a given word.</p>

<p>In this case, it would return <b>vessel</b> to enter as an associated word for <b>ship</b> (after removing morphologically similar words).</p>

<h3 id="blocks-take-your-time-puzzle-it-out">BLOCKS (take your time; puzzle it out)</h3>

<blockquote>
<p>There are 4 colored boxes that might or might not contain words, some boxes have mixed colors. Entering associated word for a box (word) will remove the same colored boxes connected to it. Similar to the good ol&rsquo; <b>tetris</b>.</p>
</blockquote>

<h4 id="game-flow-1">GAME FLOW</h4>

<p>For a human player, the blocks mode looks something like this:</p>

<ol>
<li>Enter associated word for a box connected with maximum same colored boxes</li>
<li>Keep doing this before you run out of space on your screen for new words</li>
</ol>

<figure> <img src="/images/semantris-blocks.gif">
        <figcaption>Semantris BLOCKS game</figcaption>
</figure>

<h4 id="capturing-word-with-higher-reward">CAPTURING WORD WITH HIGHER REWARD</h4>

<p>Similar to the arcade mode, there are 3 possible color themes in the blocks mode too.</p>

<figure> <img src="/images/semantris-blocks-theme-colors.jpg">
        <figcaption>Semantris BLOCKS color themes</figcaption>
</figure>

<p><b>Color palette detection</b></p>

<p>For a given theme, we need to able to distinguish the colors present in the game to find the (word) box that can give us maximum score (connected to maximum other boxes).</p>

<figure> <img src="/images/semantris-blocks-game-theme.png">
        <figcaption>Semantris BLOCKS game theme</figcaption>
</figure>

<p>This is what we get after using K-mean clustering to find all the major color segments in the captured screenshot. It includes excluding background colors such as white (text), black, and gray (text input section) etc.</p>

<figure> <img src="/images/semantris-blocks-theme-color-palette.png">
        <figcaption>Semantris BLOCKS theme color palette</figcaption>
</figure>

<p><b>Contour detection</b></p>

<blockquote>
<p>Contour is a curve joining all the continuous points (along a boundary), having same color or intensity.</p>
</blockquote>

<p>A word-box can be considered a contour of that color; if it&rsquo;s connected to more boxes with same color, the contour&rsquo;s area will be the sum of the connected boxes.</p>

<p>At any turn, <b>a random color word-box out of the 4 colors in palette</b> is selected for the duration of the game.</p>

<blockquote>
<p>It can be improved further by detecting the color with maximum contour area.</p>
</blockquote>

<p>All the contours for the selected color are detected using OpenCV&rsquo;s <a href="https://docs.opencv.org/3.3.1/d3/dc0/group__imgproc__shape.html#ga17ed9f5d79ae97bd4c7cf18403e1689a">findContours</a> method.</p>

<figure> <img src="/images/semantris-blocks-color-contours.png">
        <figcaption>Semantris BLOCKS contours for selected color</figcaption>
</figure>

<p><b>Maximum area contour detection</b></p>

<p>After converting to the gray-scale, the contour with maximum area is selected as it&rsquo;s connected with more word-boxes.</p>

<figure> <img src="/images/semantris-blocks-max-area-contour.png">
        <figcaption>Semantris BLOCKS maximum area contour</figcaption>
</figure>

<p>Similar to the arcade mode, the cropped image is converted into text using <a href="https://github.com/tesseract-ocr/tesseract">tesseract OCR</a>.</p>

<blockquote>
<p>If you like this article, follow me on <a href="https://twitter.com/hackpravj">twitter</a> to hear when I write another one.</p>
</blockquote>

      </div>
	
			

      </div>

      <div class="row paging">
			
          
          <div class="six columns">
            <a class="paging-link" href="/blog/inside-cricket/"><i class="icon-left-open"></i> Inside Cricket</a>
          </div>
          

					

      
       </div>


    </div>
  </div>

  
  <div class="container">
    <div class="row" id="disqus_area">
      <a href="#" id="disqus_load" onclick="return loadDisqus()">Add / View Comments</a>
<div id="disqus_thread"></div>

<script type="text/javascript">
  var disqus_shortname = 'pravj';

  function loadDisqus() {
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

  
  document.getElementById('disqus_load').style.display = 'none';
  return false;
}
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
  </div>
  


	

	

    <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-48537986-1', 'auto');
  ga('send', 'pageview');
</script>

    </div>
      <div class="footer">
	<hr class="thin" />
  <p>Powered by <a href="https://gohugo.io/">Hugo</a> on <a href="https://pages.github.com/">GitHub Pages</a></p>
</div>

  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://hackpravj.com/main.js"></script>






<script async defer src="https://buttons.github.io/buttons.js"></script>



</body>
</html>
